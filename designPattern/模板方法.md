# 模板方法

### 1、定义：

模板方法模式是类的行为模式。准备一个抽象类，将部分逻辑以具体方法以及具体 构造函数的形式实现，然后声明一些抽象方法来迫使子类实现剩余的逻辑。不同的 子类可以以不同的方式实现这些抽象方法，从而对剩余的逻辑有不同的实现。这就 是模板方法模式的用意。

### 2、结构：

基于继承的代码复用的基本技术。

##### 抽象模板类(Abstract Template)：

1、定义一个或者多个抽象操作，以便让子类实现。这些抽象操作叫做基本操作，他们是一个顶级逻辑的组成步骤。

2、定义并实现一个模板方法。这个模板方法一般是一个具体的方法，，它给出了 一个顶级逻辑的骨架，而逻辑的组成步骤在相应的抽象操作中，推迟到子类实现。 顶级逻辑也有可能调用一些具体方法。

抽象模板角色类，**abstractMethod()**、**hookMethod()**等基本方法是顶级逻辑的组 成步骤，这个顶级逻辑由**templateMethod()**方法代表。

```java
//模板抽象类
public abstract class AbstractTemplate {
/**
* 模板方法
*/
public void templateMethod(){
//调用基本方法
abstractMethod();
hookMethod();
concreteMethod();
}
/**
* 基本方法的声明（由子类实现）
*/
protected abstract void abstractMethod();
/**
* 基本方法(空方法)：钩子方法
*/
protected void hookMethod(){}
/**
* 基本方法（已经实现）
*/
private final void concreteMethod(){
//业务相关的代码
}
}

```



##### 具体模板(Concrete Template)类：

1、实现父类所定义的一个或多个抽象方法，它们是一个顶级逻辑的组成步骤。

2、每一个抽象模板角色都可以有任意多个具体模板角色与之对应，而每一个具 体模板角色都可以给出这些抽象方法（也就是顶级逻辑的组成步骤）的不同实现， 从而使得顶级逻辑的实现各不相同。

具体模板角色类，实现了父类所声明的基本方法，*abstractMethod()*方法所代表的 就是强制子类实现的剩余逻辑，而*hookMethod()*方法是可选择实现的逻辑，不是 必须实现的。

```java
public class ConcreteTemplate extends AbstractTemplate{
//基本方法的实现(必须实现)
@Override
public void abstractMethod() {
//业务相关的代码
}
//重写父类的方法，可以根据实际情况决定是否重写，影响模板方法中的走向
@Override
public void hookMethod() {
//业务相关的代码
}
}

```



模板模式的关键是：子类可以置换掉父类的可变部分，但是子类却不可以改变模板 方法所代表的顶级逻辑。

### 3、模板方法模式中的方法

模板方法中的方法可以分为两大类：**模板方法**和**基本方法**。

##### 1、模板方法：

一个**模板方法是定义在抽象类中**的，把基本操作方法组合在一起形成一个总算发或者总行为的方法。

一个抽象类可以有任意多个模板方法，而不限于一个。每个模板方法都可以调用任意多个具体方法。

##### 2、基本方法：

1、抽象方法：由抽象类声明，由具体子类实现。

2、具体方法：具体方法由抽象类声明并实现，而子类并不实现或置换。

3、钩子方法：钩子方法由抽象类声明并实现，而子类会加以扩展。

在上面的例子中，AbstractTemplate是一个抽象类，它带有三个方法。其中 abstractMethod()是一个抽象方法，它由抽象类声明为抽象方法，并由子类实现； hookMethod()是一个钩子方法，它由抽象类声明并提供默认实现，并且由子类置换 掉。concreteMethod()是一个具体方法，它由抽象类声明并实现。

### 4、模式效果与适用场景

(1) 对一些复杂的算法进行分割，将其算法中固定不变的部分设计为模板方法和父 类具体方法，而一些可以改变的细节由其子类来实现。即：一次性实现一个算法的 不变部分，并将可变的行为留给子类来实现。

(2) 各子类中公共的行为应被提取出来并集中到一个公共父类中以避免代码重复。

(3) 需要通过子类来决定父类算法中某个步骤是否执行，实现子类对父类的反向控制。

### 5、优缺点：

1、在父类中形式化的定义一个算法，由他的子类来实现细节的处理，在子类实现详细的处理算法时并不会改变算法中步骤的执行次序。

2、模板方法模式是一种代码复用技术，它在类库设计中尤为重要，它提取了类库 中的公共行为，将公共行为放在父类中，而通过其子类来实现不同的行为，它鼓励 我们恰当使用继承来实现代码复用。

3、) 可实现一种反向控制结构，通过子类覆盖父类的钩子方法来决定某一特定步骤 是否需要执行。

4、在模板方法模式中可以通过子类来覆盖父类的基本方法，不同的子类可以提供 基本方法的不同实现，更换和增加新的子类很方便，符合单一职责原则和开闭原 则。

缺点：

需要为每一个基本方法的不同实现提供一个子类，如果父类中可变的基本方法太 多，将会导致类的个数增加，系统更加庞大，设计也更加抽象，此时，可结合桥接 模式来进行设计。

















